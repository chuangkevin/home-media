# ğŸµ å®¶ç”¨å¤šåª’é«”ä¸­å¿ƒ

ä¸€å€‹åŠŸèƒ½å®Œæ•´çš„ YouTube éŸ³æ¨‚èˆ‡å½±ç‰‡æ’­æ”¾ä¸­å¿ƒï¼Œæ”¯æ´ç·šä¸Šä¸²æµã€æ­Œè©åŒæ­¥ã€éŸ³è¨Šè¦–è¦ºåŒ–ã€é›»å°å»£æ’­ã€è·¨è£ç½®æ§åˆ¶ã€‚

## âœ¨ æ ¸å¿ƒç‰¹è‰²

- âœ… **ç„¡éœ€ API Key** - ä½¿ç”¨ yt-dlp çˆ¬èŸ²æŠ€è¡“ï¼Œç„¡éœ€ YouTube API Key
- âœ… **ç„¡å»£å‘ŠéŸ³è¨Š** - ç›´æ¥æå–ç´”éŸ³è¨Šä¸²æµï¼Œéæ¿¾æ‰€æœ‰å»£å‘Š
- âœ… **ç·šä¸Šä¸²æµå„ªå…ˆ** - yt-dlp ç›´æ¥ä¸²æµæ’­æ”¾ï¼Œæœå°‹çµæœèƒŒæ™¯é å¿«å–
- âœ… **é›™å±¤å¿«å–** - ä¼ºæœå™¨ç«¯ç£ç¢Ÿå¿«å– (LRU, 10GB) + å‰ç«¯ IndexedDB å¿«å–
- âœ… **å½±ç‰‡/è¦–è¦ºåŒ–åˆ‡æ›** - æ”¯æ´ YouTube å½±ç‰‡åµŒå…¥æ’­æ”¾èˆ‡éŸ³è¨Šè¦–è¦ºåŒ–æ¨¡å¼
- âœ… **æ­Œè©åŒæ­¥æ»¾å‹•** - æ”¯æ´ YouTube CCã€LRCLIBã€æ‰‹å‹•æœå°‹èˆ‡æ™‚é–“å¾®èª¿
- âœ… **æ’­æ”¾æ¸…å–®ç®¡ç†** - å»ºç«‹ã€ç·¨è¼¯ã€åŒ¯å…¥/åŒ¯å‡ºæ’­æ”¾æ¸…å–®
- âœ… **é›»å°å»£æ’­æ¨¡å¼** - DJ é–‹å°å³æ™‚åŒæ­¥æ’­æ”¾ã€æ›²ç›®ã€é¡¯ç¤ºæ¨¡å¼çµ¦è½çœ¾
- âœ… **è·¨è£ç½®æŠ•å°„** - æ‰‹æ©Ÿã€å¹³æ¿æŠ•å°„æ­Œæ›²åˆ°å…¶ä»–è£ç½®æ’­æ”¾

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### å¾Œç«¯
- **Node.js** + **Express** + **TypeScript**
- **yt-dlp** (`youtube-dl-exec`) - YouTube æœå°‹èˆ‡éŸ³è¨Šä¸²æµ (ç›´æ¥ stdout pipeï¼Œé¿å… 403)
- **SQLite** (`better-sqlite3`) - æœå°‹å¿«å–ã€æ’­æ”¾è¨˜éŒ„ã€æ’­æ”¾æ¸…å–®
- **Socket.io** - WebSocket å³æ™‚é€šè¨Š (æŠ•å°„ã€é›»å°)

### å‰ç«¯
- **React 18** + **Vite** + **TypeScript**
- **Redux Toolkit** - ç‹€æ…‹ç®¡ç†
- **Web Audio API** - éŸ³è¨Šåˆ†æèˆ‡è¦–è¦ºåŒ–
- **YouTube IFrame API** - å½±ç‰‡åµŒå…¥æ’­æ”¾
- **Material-UI** - UI å…ƒä»¶åº«

### éƒ¨ç½²
- **Docker** + **docker-compose**
- **Nginx** - åå‘ä»£ç†
- **GitHub Actions** - è‡ªå‹•å»ºç½®ä¸¦æ¨é€è‡³ DockerHub

## ğŸš€ å¿«é€Ÿé–‹å§‹

### Raspberry Pi éƒ¨ç½² (æ¨è–¦)

DockerHub ä¸Šå·²æœ‰é å»ºæ˜ åƒæª” (æ”¯æ´ arm64)ï¼š

```bash
# ä¸‹è¼‰ docker-compose.yml
curl -O https://raw.githubusercontent.com/chuangkevin/home-media/main/docker-compose.yml

# å•Ÿå‹•æœå‹™
docker compose up -d

# å­˜å–æ‡‰ç”¨
# http://<your-rpi-ip>:3123
```

### æœ¬æ©Ÿ Docker é–‹ç™¼

```bash
# Clone å°ˆæ¡ˆ
git clone https://github.com/chuangkevin/home-media.git
cd home-media

# å»ºç½®ä¸¦å•Ÿå‹•
docker compose up -d --build

# å­˜å–æ‡‰ç”¨: http://localhost:3123
```

### æœ¬åœ°é–‹ç™¼

#### Windows ç”¨æˆ¶ (æ¨è–¦)

ç›´æ¥é›™æ“ŠåŸ·è¡Œæ‰¹æ¬¡æª”æ¡ˆï¼š

```bash
# å•Ÿå‹•å‰å¾Œç«¯æœå‹™
local-dev-start.bat

# åœæ­¢æ‰€æœ‰æœå‹™
local-dev-stop.bat
```

æœå‹™å•Ÿå‹•å¾Œï¼š

- **å‰ç«¯**: `http://localhost:5173`
- **å¾Œç«¯ API**: `http://localhost:3001`

#### æ‰‹å‹•å•Ÿå‹•

```bash
# å®‰è£å¾Œç«¯ä¾è³´
cd backend
npm install
npm run dev

# å®‰è£å‰ç«¯ä¾è³´
cd ../frontend
npm install
npm run dev
```

## ğŸ”§ ç–‘é›£æ’è§£

### YouTube 403 éŒ¯èª¤ï¼ˆç„¡æ³•æ’­æ”¾ï¼‰

æœ¬å°ˆæ¡ˆä½¿ç”¨ **yt-dlp ç›´æ¥ä¸²æµ**ï¼ˆstdout pipeï¼‰æ’­æ”¾éŸ³è¨Šï¼Œé¿å…æå– URL å¾Œè¢« YouTube å°é–ã€‚

å¦‚æœä»é‡åˆ° 403 éŒ¯èª¤ï¼Œé€šå¸¸æ˜¯ yt-dlp ç‰ˆæœ¬éèˆŠï¼š

```bash
# Docker éƒ¨ç½²ï¼šé‡æ–°æ‹‰å–æ˜ åƒï¼ˆå…§å«æœ€æ–° yt-dlpï¼‰
docker compose down && docker compose pull && docker compose up -d

# æœ¬åœ°é–‹ç™¼ï¼šæ‰‹å‹•æ›´æ–° yt-dlp
cd backend
npx --yes youtube-dl-exec --update
# æˆ–ç›´æ¥åŸ·è¡Œ yt-dlp æ›´æ–°
node_modules/youtube-dl-exec/bin/yt-dlp --update
```

å¦‚æœå•é¡ŒæŒçºŒï¼Œå¯èƒ½æ˜¯ YouTube æ›´æ–°äº†å°é–æ©Ÿåˆ¶ï¼Œè«‹æª¢æŸ¥ [GitHub Issues](https://github.com/chuangkevin/home-media/issues)ã€‚

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```text
home-media/
â”œâ”€â”€ backend/              # Node.js å¾Œç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ services/     # YouTubeã€æ­Œè©ã€éŸ³è¨Šå¿«å–ã€é›»å°æœå‹™
â”‚   â”‚   â”œâ”€â”€ controllers/  # API æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ handlers/     # WebSocket äº‹ä»¶è™•ç† (æŠ•å°„ã€é›»å°)
â”‚   â”‚   â”œâ”€â”€ config/       # ç’°å¢ƒè¨­å®šã€è³‡æ–™åº«åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ routes/       # Express è·¯ç”±
â”‚   â”‚   â””â”€â”€ utils/        # Logger ç­‰å·¥å…·
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ frontend/             # React å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/   # UI å…ƒä»¶ (Player, Radio, Playlist, Lyrics...)
â”‚   â”‚   â”œâ”€â”€ hooks/        # React Hooks (useRadio, useRadioSync...)
â”‚   â”‚   â”œâ”€â”€ store/        # Redux Store (player, radio slices)
â”‚   â”‚   â””â”€â”€ services/     # Socket.io æœå‹™
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ docker-compose.yml    # Docker ç·¨æ’
â””â”€â”€ data/                 # æŒä¹…åŒ–è³‡æ–™
    â”œâ”€â”€ audio-cache/      # ä¼ºæœå™¨ç«¯éŸ³è¨Šå¿«å– (LRU, 10GB)
    â””â”€â”€ db/               # SQLite è³‡æ–™åº«
```

## ğŸ¯ é–‹ç™¼è·¯ç·šåœ–

- [x] éšæ®µ 1: åŸºç¤è¨­æ–½
- [x] éšæ®µ 2: YouTube æ•´åˆ (yt-dlp æœå°‹ã€ä¸²æµã€ä¸­æ–‡æ¨™é¡Œæ”¯æ´)
- [x] éšæ®µ 3: éŸ³è¨Šè¦–è¦ºåŒ–
- [x] éšæ®µ 4: æ­Œè©é¡¯ç¤º (YouTube CC + LRCLIB å‚™æ´ + æ‰‹å‹•æœå°‹)
- [ ] éšæ®µ 5: æ›²é¢¨ä¸»é¡Œèˆ‡è‡ªå‹•æ¨è–¦
  - [ ] YouTube Tags æå– (æ¨™ç±¤ã€åˆ†é¡ã€èªè¨€)
  - [ ] Spotify API æ•´åˆ (æ›²é¢¨ã€åœ‹å®¶ã€éŸ³æ¨‚ç‰¹å¾µ)
  - [ ] æ¨è–¦å¼•æ“ (åŸºæ–¼æ›²é¢¨ã€åœ‹å®¶ã€é¡å‹ç›¸ä¼¼åº¦)
  - [ ] è‡ªå‹•æ’­æ”¾ä½‡åˆ— (æ’­æ”¾å®Œè‡ªå‹•æ¨è–¦é¡ä¼¼å…§å®¹)
  - [ ] æ”¯æ´éŸ³æ¨‚ã€èªªæ•…äº‹ã€æ¡ˆä»¶é »é“ç­‰å¤šç¨®å…§å®¹é¡å‹
  - [ ] é›»å°æ¨¡å¼æ•´åˆæ¨è–¦ç³»çµ±
- [x] éšæ®µ 6: æ’­æ”¾æ¸…å–®ç®¡ç†
- [x] éšæ®µ 7: å¿«å–ç³»çµ± (ä¼ºæœå™¨ç«¯ç£ç¢Ÿ 10GB + å‰ç«¯ IndexedDB)
- [x] éšæ®µ 8: é ç«¯æ§åˆ¶ (Socket.io æŠ•å°„åŠŸèƒ½)
- [x] éšæ®µ 9: é›»å°å»£æ’­ (DJ/è½çœ¾å³æ™‚åŒæ­¥)
- [x] éšæ®µ 10: Docker éƒ¨ç½² + GitHub Actions CI/CD
- [x] éšæ®µ 11: å½±ç‰‡æ¨¡å¼ (YouTube IFrame åµŒå…¥ + éŸ³è¨Š/å½±ç‰‡åˆ‡æ›)
- [x] éšæ®µ 12: ä¼ºæœå™¨ç«¯é å¿«å– (æœå°‹çµæœèƒŒæ™¯ä¸‹è¼‰)
- [ ] éšæ®µ 13: æ’­æ”¾æ•ˆèƒ½å„ªåŒ–
  - [ ] éŸ³è¨Šä¸²æµå„ªåŒ– (é™ä½é¦–æ¬¡æ’­æ”¾å»¶é²)
  - [ ] é æ¸¬æ€§é è¼‰ (AI é æ¸¬ä¸‹ä¸€é¦–ä¸¦é å…ˆè¼‰å…¥)
  - [ ] CDN æ•´åˆ (å…¨çƒåŠ é€Ÿ)
  - [ ] Adaptive Bitrate (æ ¹æ“šç¶²è·¯é€Ÿåº¦èª¿æ•´éŸ³è³ª)

## ğŸ“ å…è²¬è²æ˜

æœ¬å°ˆæ¡ˆåƒ…ä¾›**å€‹äººå­¸ç¿’èˆ‡éå•†æ¥­ç”¨é€”**ã€‚ä½¿ç”¨è€…éœ€è‡ªè¡Œéµå®ˆ YouTube æœå‹™æ¢æ¬¾åŠç•¶åœ°æ³•è¦ã€‚å¿«å–åŠŸèƒ½åƒ…ç”¨æ–¼æ”¹å–„æ’­æ”¾é«”é©—ï¼Œéæ°¸ä¹…å„²å­˜ã€‚

## ğŸ“„ æˆæ¬Š

MIT License
